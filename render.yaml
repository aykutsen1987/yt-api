# ============================================
# RENDER Deployment Configuration
# YouTube to MP3/M4A Converter API
# ============================================

services:
  - type: web
    name: yt-api
    env: python
    region: oregon
    plan: free
    
    # ‚ùå buildCommand'dan apt-get komutunu KALDIRIN
    buildCommand: |
      echo "üì¶ Installing Python dependencies..."
      pip install --upgrade pip
      pip install -r requirements.txt
      echo "‚úÖ Build complete"
    
    # ‚úÖ Start Command - Uvicorn server
    startCommand: uvicorn main:app --host 0.0.0.0 --port $PORT --workers 2
    
    # ‚úÖ Environment Variables
    envVars:
      - key: PYTHON_VERSION
        value: 3.11.0
      
      - key: PORT
        value: 10000
      
      - key: LOG_LEVEL
        value: info
      
      - key: WORKERS
        value: 2
      
      # ‚úÖ FFmpeg path (RENDER'da default)
      - key: FFMPEG_PATH
        value: /usr/bin/ffmpeg
      
      # ‚úÖ Temp directory
      - key: TEMP_DIR
        value: /tmp
    
    # ‚úÖ Health Check
    healthCheckPath: /health
    
    # ‚úÖ Auto Deploy (GitHub push'ta otomatik deploy)
    autoDeploy: true
    
    # ‚úÖ Branch
    branch: main  # veya master
    
    # ‚úÖ Root Directory (eƒüer subdirectory'deyse)
    # rootDir: backend
    
    # ‚úÖ Disk (persistent storage - opsiyonel)
    # disk:
    #   name: yt-api-disk
    #   mountPath: /data
    #   sizeGB: 1

# ============================================
# RENDER PLAN RECOMMENDATIONS
# ============================================
# 
# FREE PLAN:
# - 512 MB RAM
# - 0.1 CPU
# - Cold start (30-60s inactivity sonrasƒ±)
# - Aylƒ±k 750 saat
# - Yeterli: Test ve d√º≈ü√ºk trafik
#
# STARTER PLAN ($7/month):
# - 512 MB RAM
# - 0.5 CPU
# - Always on (cold start yok)
# - √ñnerilen: Production kullanƒ±m
#
# STANDARD PLAN ($25/month):
# - 2 GB RAM
# - 1 CPU
# - Always on
# - √ñnerilen: Y√ºksek trafik
#
# ============================================

# ============================================
# ALTERNATIVE: Aptfile (FFmpeg i√ßin)
# ============================================
# Eƒüer buildCommand'da apt-get √ßalƒ±≈ümazsa,
# proje root'una "Aptfile" dosyasƒ± ekleyin:
#
# Aptfile i√ßeriƒüi:
# ffmpeg
#
# ============================================
